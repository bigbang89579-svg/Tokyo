<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>2026 æ±äº¬ãƒ»NijiFes è¡Œç¨‹ï¼ˆå¯ç·¨è¼¯ï¼‹è‡ªå‹•æ—¥æœŸï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #f5f5fa;
      --primary: #4f46e5;
      --primary-soft: #eef2ff;
      --accent: #f97316;
      --card-bg: #ffffff;
      --border: #e5e7eb;
      --text-main: #111827;
      --text-sub: #6b7280;
      --tab-bg: #e5e7eb;
      --tab-active: #ffffff;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
    }

    body {
      background: var(--bg);
      color: var(--text-main);
      padding: 16px;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
    }

    header {
      margin-bottom: 16px;
    }

    header h1 {
      font-size: 1.6rem;
      font-weight: 700;
      margin-bottom: 6px;
    }

    header p {
      font-size: 0.9rem;
      color: var(--text-sub);
    }

    .year-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: #facc15;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.8rem;
      font-weight: 600;
      margin-top: 8px;
    }

    /* Tabs */
    .tabs {
      display: flex;
      gap: 4px;
      background: var(--tab-bg);
      padding: 4px;
      border-radius: 999px;
      margin: 12px 0 18px;
    }

    .tab {
      flex: 1;
      text-align: center;
      padding: 8px 12px;
      border-radius: 999px;
      font-size: 0.9rem;
      cursor: pointer;
      border: none;
      background: transparent;
      color: var(--text-sub);
      font-weight: 500;
      transition: all 0.18s ease;
    }

    .tab.active {
      background: var(--tab-active);
      color: var(--primary);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
    }

    main {
      background: var(--card-bg);
      border-radius: 14px;
      padding: 14px;
      box-shadow: 0 10px 25px rgba(15, 23, 42, 0.08);
    }

    .tab-panel {
      display: none;
    }

    .tab-panel.active {
      display: block;
    }

    /* è¡Œç¨‹å¯ç·¨è¼¯å€ */
    .trip-note {
      font-size: 0.8rem;
      color: var(--text-sub);
      margin-bottom: 8px;
    }

    .date-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
      flex-wrap: wrap;
    }

    .date-label {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.8rem;
      color: var(--text-sub);
    }

    .date-label input[type="date"] {
      padding: 4px 6px;
      border-radius: 6px;
      border: 1px solid var(--border);
      font-size: 0.85rem;
      background: #fff;
    }

    .controls {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }

    .btn {
      border-radius: 999px;
      border: none;
      padding: 6px 12px;
      font-size: 0.85rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: var(--primary);
      color: white;
      font-weight: 500;
    }

    .btn-ghost {
      border-radius: 999px;
      border: 1px solid var(--border);
      padding: 4px 10px;
      font-size: 0.8rem;
      cursor: pointer;
      background: #f9fafb;
      color: var(--text-sub);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .btn-small {
      font-size: 0.8rem;
      padding: 4px 10px;
    }

    .day-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .day-card {
      background: #f9fafb;
      border-radius: 12px;
      border: 1px solid var(--border);
      padding: 10px 10px 8px;
      cursor: grab;
    }

    .day-card.dragging {
      opacity: 0.6;
      border-style: dashed;
    }

    .day-header {
      display: flex;
      justify-content: space-between;
      gap: 8px;
      align-items: center;
      margin-bottom: 6px;
    }

    .day-title {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .day-label {
      background: var(--primary);
      color: white;
      border-radius: 999px;
      padding: 2px 10px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .day-date {
      font-size: 0.9rem;
      font-weight: 600;
    }

    .area-tag {
      font-size: 0.75rem;
      padding: 2px 8px;
      border-radius: 999px;
      background: #fee2e2;
      color: #b91c1c;
    }

    .area-tag.editable {
      padding: 2px 8px;
    }

    .spots {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 4px;
    }

    .spot-card {
      background: white;
      border-radius: 10px;
      border: 1px solid var(--border);
      padding: 8px;
      cursor: grab;
    }

    .spot-card.dragging {
      opacity: 0.6;
      border-style: dashed;
    }

    .spot-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
    }

    .spot-title-label {
      font-size: 0.8rem;
      color: var(--text-sub);
    }

    .editable {
      padding: 4px 6px;
      border-radius: 6px;
      border: 1px dashed transparent;
      min-height: 20px;
    }

    .editable:focus {
      outline: none;
      border-color: var(--primary);
      background: #eef2ff;
    }

    .field-label {
      font-size: 0.8rem;
      color: var(--text-sub);
      margin-top: 4px;
      margin-bottom: 2px;
    }

    .image-list,
    .note-image-list {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin: 4px 0;
    }

    .image-list img,
    .note-image-list img {
      width: 70px;
      height: 70px;
      object-fit: cover;
      border-radius: 8px;
      border: 1px solid var(--border);
    }

    .spot-note {
      margin-top: 6px;
      padding-top: 6px;
      border-top: 1px dashed var(--border);
    }

    .note-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 6px;
    }

    .note-header span {
      font-size: 0.8rem;
      color: var(--text-sub);
      font-weight: 500;
    }

    .file-input {
      display: none;
    }

    /* å…¶ä»–åˆ†é  */
    .section-box {
      border-radius: 10px;
      border: 1px dashed var(--border);
      padding: 12px;
      font-size: 0.85rem;
      color: var(--text-sub);
      margin-top: 10px;
    }

    .section-box h3 {
      font-size: 0.95rem;
      margin-bottom: 6px;
      color: var(--text-main);
    }

    .pill-list {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 4px;
    }

    .pill {
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid var(--border);
      font-size: 0.75rem;
      background: #f9fafb;
    }

    @media (max-width: 640px) {
      header h1 {
        font-size: 1.3rem;
      }
      main {
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>2026 æ±äº¬ãƒ»NijiFes è¡Œç¨‹ï¼ˆå¯ç·¨è¼¯ï¼‹è‡ªå‹•æ—¥æœŸï¼‰</h1>
      <p>è¨­å®šå‡ºç™¼æ—¥æœŸå¾Œï¼ŒDay1 ~ DayN çš„æ—¥æœŸæœƒè‡ªå‹•è¨ˆç®—ï¼›å¯æ‹–æ‹‰èª¿æ•´é †åºã€ç·¨è¼¯å…§å®¹ã€å¹«æ™¯é»åŠ åœ–ç‰‡èˆ‡å‚™è¨»ã€‚</p>
      <div class="year-badge">
        <span>ğŸ“… æ—…ç¨‹å¹´ä»½</span> <strong>2026</strong>
      </div>
    </header>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab active" data-tab="schedule">è¡Œç¨‹</button>
      <button class="tab" data-tab="cost">ç¸½èŠ±è²»</button>
      <button class="tab" data-tab="nijifes">NijiFes å‘¨é‚Š</button>
    </div>

    <main>
      <!-- è¡Œç¨‹åˆ†é  -->
      <section id="schedule" class="tab-panel active">
        <p class="trip-note">
          æç¤ºï¼šè¨­å®šã€Œå‡ºç™¼æ—¥æœŸã€å¾Œï¼Œæ¯ä¸€å€‹ Day çš„æ—¥æœŸæœƒè‡ªå‹•ä¾ç…§é †åºå¾€å¾Œæ¨ç®—ï¼›æ‹–æ‹‰æ—¥æœŸå¡ç‰‡æ”¹é †åºä¹Ÿæœƒè‡ªå‹•æ›´æ–°ã€‚
        </p>

        <div class="date-row">
          <label class="date-label">
            å‡ºç™¼æ—¥æœŸï¼š
            <!-- é è¨­ 2026-05-08ï¼Œå¯æ”¹æˆä½ å¯¦éš›å‡ºç™¼æ—¥ -->
            <input type="date" id="start-date" value="2026-05-08" />
          </label>
        </div>

        <div class="controls">
          <button class="btn" id="add-day-btn">ï¼‹ æ–°å¢ä¸€å¤©</button>
        </div>

        <div class="day-list" id="day-list">
          <!-- Day 1 -->
          <article class="day-card" draggable="true">
            <div class="day-header">
              <div class="day-title">
                <span class="day-label">Day 1</span>
                <span class="day-date"></span>
                <span class="area-tag editable" contenteditable="true">æˆç”°ãƒ»ä¸Šé‡</span>
              </div>
              <button class="btn-ghost btn-small add-spot-btn">ï¼‹ æ–°å¢æ™¯é»</button>
            </div>

            <div class="spots">
              <div class="spot-card" draggable="true">
                <div class="spot-top">
                  <span class="spot-title-label">æ™¯é»å¡ç‰‡</span>
                  <div>
                    <button class="btn-ghost btn-small upload-image-btn">ğŸ–¼ æ–°å¢åœ–ç‰‡</button>
                    <input type="file" accept="image/*" multiple class="file-input image-input" />
                  </div>
                </div>

                <div class="image-list"></div>

                <div class="field-label">æ™¯é»åç¨±</div>
                <div class="editable" contenteditable="true">
                  æˆç”°æ©Ÿå ´ â†’ æ±äº¬å¸‚å€
                </div>

                <div class="field-label">åœ°é»ï¼åœ°å€ï¼æ™‚é–“</div>
                <div class="editable" contenteditable="true">
                  å…¥å¢ƒå¾Œå‰å¾€ä¸Šé‡é£¯åº—ï¼Œæ”¾è¡Œæå¾Œé™„è¿‘é€›é€›ã€‚<br />
                  ä½å®¿ï¼šVESSEL INN UENO IRIYA STATIONï¼ˆå¯è‡ªè¡Œä¿®æ”¹ï¼‰
                </div>

                <div class="spot-note">
                  <div class="note-header">
                    <span>å‚™è¨»</span>
                    <div>
                      <button class="btn-ghost btn-small upload-note-image-btn">ğŸ–¼ æ–°å¢åœ–ç‰‡</button>
                      <input type="file" accept="image/*" multiple class="file-input note-image-input" />
                    </div>
                  </div>
                  <div class="note-image-list"></div>
                  <div class="editable" contenteditable="true">
                    é€™è£¡å¯ä»¥è¨˜éŒ„èˆªç­è³‡è¨Šã€å…¥å¢ƒæ³¨æ„äº‹é …ç­‰ã€‚
                  </div>
                </div>
              </div>
            </div>
          </article>

          <!-- Day 2 -->
          <article class="day-card" draggable="true">
            <div class="day-header">
              <div class="day-title">
                <span class="day-label">Day 2</span>
                <span class="day-date"></span>
                <span class="area-tag editable" contenteditable="true">ä¸Šé‡ãƒ»ç§‹è‘‰åŸ</span>
              </div>
              <button class="btn-ghost btn-small add-spot-btn">ï¼‹ æ–°å¢æ™¯é»</button>
            </div>

            <div class="spots">
              <div class="spot-card" draggable="true">
                <div class="spot-top">
                  <span class="spot-title-label">æ™¯é»å¡ç‰‡</span>
                  <div>
                    <button class="btn-ghost btn-small upload-image-btn">ğŸ–¼ æ–°å¢åœ–ç‰‡</button>
                    <input type="file" accept="image/*" multiple class="file-input image-input" />
                  </div>
                </div>
                <div class="image-list"></div>

                <div class="field-label">æ™¯é»åç¨±</div>
                <div class="editable" contenteditable="true">
                  ä¸Šé‡å…¬åœ’ãƒ»é˜¿ç¾æ©«ä¸ãƒ»ç§‹è‘‰åŸ
                </div>

                <div class="field-label">åœ°é»ï¼åœ°å€ï¼æ™‚é–“</div>
                <div class="editable" contenteditable="true">
                  ä¾è©¦ç®—è¡¨å®‰æ’ï¼Œä¸Šé‡å‘¨é‚Šæ•£æ­¥ã€æˆ°åˆ©å“æ¡è²·ã€å‰å¾€ç§‹è‘‰åŸé€›åº—ã€‚
                </div>

                <div class="spot-note">
                  <div class="note-header">
                    <span>å‚™è¨»</span>
                    <div>
                      <button class="btn-ghost btn-small upload-note-image-btn">ğŸ–¼ æ–°å¢åœ–ç‰‡</button>
                      <input type="file" accept="image/*" multiple class="file-input note-image-input" />
                    </div>
                  </div>
                  <div class="note-image-list"></div>
                  <div class="editable" contenteditable="true">
                    å¯ä»¥è¨˜éŒ„æƒ³å»çš„åº—å®¶ã€é¤å»³åç¨±ã€é ç®—ç­‰ç­‰ã€‚
                  </div>
                </div>
              </div>
            </div>
          </article>

          <!-- Day 3 (æ¾€è°·ãƒ»åŸå®¿) -->
          <article class="day-card" draggable="true">
            <div class="day-header">
              <div class="day-title">
                <span class="day-label">Day 3</span>
                <span class="day-date"></span>
                <span class="area-tag editable" contenteditable="true">æ¾€è°·ãƒ»åŸå®¿</span>
              </div>
              <button class="btn-ghost btn-small add-spot-btn">ï¼‹ æ–°å¢æ™¯é»</button>
            </div>

            <div class="spots">
              <div class="spot-card" draggable="true">
                <div class="spot-top">
                  <span class="spot-title-label">æ™¯é»å¡ç‰‡</span>
                  <div>
                    <button class="btn-ghost btn-small upload-image-btn">ğŸ–¼ æ–°å¢åœ–ç‰‡</button>
                    <input type="file" accept="image/*" multiple class="file-input image-input" />
                  </div>
                </div>
                <div class="image-list"></div>

                <div class="field-label">æ™¯é»åç¨±</div>
                <div class="editable" contenteditable="true">
                  Kiddy Landãƒ»ç«¹ä¸‹é€šãƒ»è¡¨åƒé“
                </div>

                <div class="field-label">åœ°é»ï¼åœ°å€ï¼æ™‚é–“</div>
                <div class="editable" contenteditable="true">
                  Kiddy Land åŸå®¿æœ¬åº—ï¼ˆæ±äº¬éƒ½æ¸‹è°·åŒºç¥å®®å‰6-1-9ï¼‰ã€‚<br />
                  å…¶ä»–åº—å®¶èˆ‡æ™‚é–“å¯è‡ªè¡Œè£œä¸Šã€‚
                </div>

                <div class="spot-note">
                  <div class="note-header">
                    <span>å‚™è¨»</span>
                    <div>
                      <button class="btn-ghost btn-small upload-note-image-btn">ğŸ–¼ æ–°å¢åœ–ç‰‡</button>
                      <input type="file" accept="image/*" multiple class="file-input note-image-input" />
                    </div>
                  </div>
                  <div class="note-image-list"></div>
                  <div class="editable" contenteditable="true">
                    å¯ä»¥é™„ä¸Šåº—å®¶åœ°åœ–æˆªåœ–ã€æ’éšŠç¶“é©—ç­‰ç­‰ã€‚
                  </div>
                </div>
              </div>
            </div>
          </article>

          <!-- NijiFes Day ç¤ºä¾‹ -->
          <article class="day-card" draggable="true">
            <div class="day-header">
              <div class="day-title">
                <span class="day-label">Day 4</span>
                <span class="day-date"></span>
                <span class="area-tag editable" contenteditable="true">NijiFes Day 1</span>
              </div>
              <button class="btn-ghost btn-small add-spot-btn">ï¼‹ æ–°å¢æ™¯é»</button>
            </div>

            <div class="spots">
              <div class="spot-card" draggable="true">
                <div class="spot-top">
                  <span class="spot-title-label">æ™¯é»å¡ç‰‡</span>
                  <div>
                    <button class="btn-ghost btn-small upload-image-btn">ğŸ–¼ æ–°å¢åœ–ç‰‡</button>
                    <input type="file" accept="image/*" multiple class="file-input image-input" />
                  </div>
                </div>
                <div class="image-list"></div>

                <div class="field-label">æ™¯é»åç¨±</div>
                <div class="editable" contenteditable="true">
                  NijiFes æœƒå ´ï¼ˆå¹•å¼µå±•è¦½é¤¨ï¼‰
                </div>

                <div class="field-label">åœ°é»ï¼åœ°å€ï¼æ™‚é–“</div>
                <div class="editable" contenteditable="true">
                  åƒè‘‰å¸‚ç¾æµœåŒºä¸­ç€¬2-1ã€‚<br />
                  å¯¦éš›å…¥å ´æ™‚é–“èˆ‡å ´æ¬¡è«‹ä¾å®˜æ–¹è³‡è¨Šæ›´æ–°ã€‚
                </div>

                <div class="spot-note">
                  <div class="note-header">
                    <span>å‚™è¨»</span>
                    <div>
                      <button class="btn-ghost btn-small upload-note-image-btn">ğŸ–¼ æ–°å¢åœ–ç‰‡</button>
                      <input type="file" accept="image/*" multiple class="file-input note-image-input" />
                    </div>
                  </div>
                  <div class="note-image-list"></div>
                  <div class="editable" contenteditable="true">
                    å¯æ”¾å‘¨é‚Šè³¼ç‰©æ¸…å–®ã€æ’éšŠå‹•ç·šã€æƒ³çœ‹çš„èˆå°æ™‚é–“ç­‰ã€‚
                  </div>
                </div>
              </div>
            </div>
          </article>
        </div>
      </section>

      <!-- ç¸½èŠ±è²»åˆ†é  -->
      <section id="cost" class="tab-panel">
        <h2>ç¸½èŠ±è²»æ•´ç†</h2>
        <p class="trip-note">
          é€™ä¸€é é ç•™çµ¦ä½ æŠŠè©¦ç®—è¡¨ä¸­çš„ã€Œç¸½èŠ±è²»ã€æ•´ç†é€²ä¾†ï¼ˆæ©Ÿç¥¨ / ä½å®¿ / äº¤é€š / é–€ç¥¨ / é¤é£² / è³¼ç‰©ç­‰ï¼‰ã€‚
        </p>

        <div class="section-box">
          <h3>å»ºè­°å€å¡Š</h3>
          <ul>
            <li>æ©Ÿç¥¨èˆ‡æ—…éŠä¿éšª</li>
            <li>ä½å®¿ç¸½é‡‘é¡ï¼ˆå¯ä¾åŸå¸‚æˆ–é£¯åº—æ‹†é–‹ï¼‰</li>
            <li>äº¤é€šè²»ï¼ˆJR PASSã€Suica å……å€¼ã€æ©Ÿå ´å¿«ç·šç­‰ï¼‰</li>
            <li>æ´»å‹•ç¥¨åˆ¸ï¼ˆNijiFes é–€ç¥¨ã€æ™¯é»é–€ç¥¨ï¼‰</li>
            <li>é¤é£²èˆ‡è³¼ç‰©é ç®—</li>
          </ul>

          <div class="pill-list">
            <div class="pill">ğŸ’´ æ—¥å¹£é ç®—</div>
            <div class="pill">ğŸ’µ æ›åŒ¯é‡‘é¡</div>
            <div class="pill">ğŸ§¾ æ¯æ—¥å¤§è‡´èŠ±è²»</div>
            <div class="pill">ğŸ“Š ç¸½çµ &amp; å›é¡§</div>
          </div>
        </div>
      </section>

      <!-- NijiFes åˆ†é  -->
      <section id="nijifes" class="tab-panel">
        <h2>NijiFes å‘¨é‚Šï¼æ´»å‹•å°ˆå€</h2>
        <p class="trip-note">
          å°ˆé–€æ”¾ NijiFes ç›¸é—œè³‡è¨Šï¼šæœƒå ´é…ç½®ã€å‘¨é‚Šé ç®—ã€æ’éšŠç­–ç•¥ã€æƒ³çœ‹çš„èˆå°å ´æ¬¡ç­‰ç­‰ã€‚
        </p>

        <div class="section-box">
          <h3>å¯ä»¥åœ¨é€™è£¡ç´€éŒ„çš„å…§å®¹</h3>
          <ul>
            <li>æƒ³è²·çš„å‘¨é‚Šæ¸…å–®ï¼†é ç®—</li>
            <li>å„æˆå“¡ï¼ä¼åŠƒçš„å¿…è²·é …ç›®</li>
            <li>æ’éšŠæ™‚é–“èˆ‡å‹•ç·šç­†è¨˜</li>
            <li>èˆå°æ´»å‹•æ™‚é–“è¡¨ï¼ˆèª°çš„èˆå°ä¸€å®šè¦çœ‹ï¼‰</li>
            <li>æœƒå ´é™„è¿‘çš„ç”¨é¤ï¼ä¼‘æ¯é»</li>
          </ul>

          <div class="pill-list">
            <div class="pill">ğŸ› å‘¨é‚Šè³¼ç‰©æ¸…å–®</div>
            <div class="pill">ğŸ¤ èˆå°è¡Œç¨‹</div>
            <div class="pill">ğŸ“ æœƒå ´åœ°åœ–å‚™è¨»</div>
            <div class="pill">ğŸ’³ é è¨ˆèŠ±è²»</div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script>
    // ---------------- Tab åˆ‡æ› ----------------
    const tabs = document.querySelectorAll(".tab");
    const panels = document.querySelectorAll(".tab-panel");

    tabs.forEach((tab) => {
      tab.addEventListener("click", () => {
        const target = tab.dataset.tab;
        tabs.forEach((t) => t.classList.remove("active"));
        panels.forEach((p) => p.classList.remove("active"));
        tab.classList.add("active");
        document.getElementById(target).classList.add("active");
      });
    });

    // ---------------- åˆå§‹åŒ– ----------------
    function init() {
      initDayDragAndDrop();
      initSpotDragAndDrop();
      initImageButtons();
      initAddSpotButtons();
      initAddDayButton();
      initStartDate();
      updateDayLabels(); // æœƒé †ä¾¿ç®—æ—¥æœŸ
    }

    // ---------------- å‡ºç™¼æ—¥æœŸ & è‡ªå‹•æ—¥æœŸ ----------------
    function initStartDate() {
      const startInput = document.getElementById("start-date");
      if (!startInput) return;
      startInput.addEventListener("change", () => {
        updateDates(); // ä¿®æ”¹å‡ºç™¼æ—¥æœŸå°±é‡ç®—
      });
    }

    function formatDate(date) {
      const month = date.getMonth() + 1;
      const day = date.getDate();
      const weekdays = ["æ—¥", "ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­"];
      const w = weekdays[date.getDay()];
      return `${month}/${day} (${w})`;
    }

    function updateDates() {
      const startInput = document.getElementById("start-date");
      if (!startInput || !startInput.value) return;

      const base = new Date(startInput.value);
      if (isNaN(base.getTime())) return;

      const dayCards = document.querySelectorAll("#day-list .day-card");
      dayCards.forEach((card, index) => {
        const span = card.querySelector(".day-date");
        if (!span) return;
        const d = new Date(base);
        d.setDate(d.getDate() + index); // Day1 = å‡ºç™¼æ—¥ï¼ŒDay2 = +1 ...
        span.textContent = formatDate(d);
      });
    }

    // ---------------- æ‹–æ‹‰æ’åºï¼šDay ----------------
    function initDayDragAndDrop() {
      const dayList = document.getElementById("day-list");
      let draggingCard = null;

      dayList.querySelectorAll(".day-card").forEach((card) => {
        card.addEventListener("dragstart", (e) => {
          draggingCard = card;
          card.classList.add("dragging");
          e.dataTransfer.effectAllowed = "move";
        });

        card.addEventListener("dragend", () => {
          if (draggingCard) {
            draggingCard.classList.remove("dragging");
            draggingCard = null;
            updateDayLabels(); // æ‹–å®Œé‡æ’ Day ç·¨è™Ÿ & æ—¥æœŸ
          }
        });
      });

      dayList.addEventListener("dragover", (e) => {
        e.preventDefault();
        const afterElement = getDragAfterElement(dayList, e.clientY);
        const draggable = dayList.querySelector(".day-card.dragging");
        if (!draggable) return;
        if (afterElement == null) {
          dayList.appendChild(draggable);
        } else {
          dayList.insertBefore(draggable, afterElement);
        }
      });
    }

    function getDragAfterElement(container, y) {
      const draggableElements = [
        ...container.querySelectorAll(".day-card:not(.dragging)"),
      ];

      return draggableElements.reduce(
        (closest, child) => {
          const box = child.getBoundingClientRect();
          const offset = y - box.top - box.height / 2;
          if (offset < 0 && offset > closest.offset) {
            return { offset: offset, element: child };
          } else {
            return closest;
          }
        },
        { offset: Number.NEGATIVE_INFINITY, element: null }
      ).element;
    }

    // ---------------- æ‹–æ‹‰æ’åºï¼šæ™¯é»å¡ç‰‡ ----------------
    function initSpotDragAndDrop() {
      document.querySelectorAll(".spots").forEach((spotsContainer) => {
        let draggingSpot = null;

        spotsContainer.querySelectorAll(".spot-card").forEach((card) => {
          card.addEventListener("dragstart", (e) => {
            draggingSpot = card;
            card.classList.add("dragging");
            e.dataTransfer.effectAllowed = "move";
          });

          card.addEventListener("dragend", () => {
            if (draggingSpot) {
              draggingSpot.classList.remove("dragging");
              draggingSpot = null;
            }
          });
        });

        spotsContainer.addEventListener("dragover", (e) => {
          e.preventDefault();
          const afterElement = getDragAfterElementSpot(
            spotsContainer,
            e.clientY
          );
          const draggable = spotsContainer.querySelector(".spot-card.dragging");
          if (!draggable) return;
          if (afterElement == null) {
            spotsContainer.appendChild(draggable);
          } else {
            spotsContainer.insertBefore(draggable, afterElement);
          }
        });
      });
    }

    function getDragAfterElementSpot(container, y) {
      const draggableElements = [
        ...container.querySelectorAll(".spot-card:not(.dragging)"),
      ];

      return draggableElements.reduce(
        (closest, child) => {
          const box = child.getBoundingClientRect();
          const offset = y - box.top - box.height / 2;
          if (offset < 0 && offset > closest.offset) {
            return { offset: offset, element: child };
          } else {
            return closest;
          }
        },
        { offset: Number.NEGATIVE_INFINITY, element: null }
      ).element;
    }

    // ---------------- æ–°å¢åœ–ç‰‡ï¼ˆæ™¯é» & å‚™è¨»ï¼‰ ----------------
    function initImageButtons(root = document) {
      // æ™¯é»åœ–ç‰‡
      root.querySelectorAll(".upload-image-btn").forEach((btn) => {
        const input = btn.parentElement.querySelector(".image-input");
        const list = btn.closest(".spot-card").querySelector(".image-list");

        btn.addEventListener("click", () => input.click());

        input.addEventListener("change", () => {
          Array.from(input.files).forEach((file) => {
            const reader = new FileReader();
            reader.onload = (e) => {
              const img = document.createElement("img");
              img.src = e.target.result;
              list.appendChild(img);
            };
            reader.readAsDataURL(file);
          });
          input.value = "";
        });
      });

      // å‚™è¨»åœ–ç‰‡
      root.querySelectorAll(".upload-note-image-btn").forEach((btn) => {
        const input = btn.parentElement.querySelector(".note-image-input");
        const list = btn
          .closest(".spot-card")
          .querySelector(".note-image-list");

        btn.addEventListener("click", () => input.click());

        input.addEventListener("change", () => {
          Array.from(input.files).forEach((file) => {
            const reader = new FileReader();
            reader.onload = (e) => {
              const img = document.createElement("img");
              img.src = e.target.result;
              list.appendChild(img);
            };
            reader.readAsDataURL(file);
          });
          input.value = "";
        });
      });
    }

    // ---------------- æ–°å¢æ™¯é»å¡ç‰‡ ----------------
    function initAddSpotButtons(root = document) {
      root.querySelectorAll(".add-spot-btn").forEach((btn) => {
        btn.addEventListener("click", () => {
          const dayCard = btn.closest(".day-card");
          const spots = dayCard.querySelector(".spots");

          const template = document.createElement("div");
          template.className = "spot-card";
          template.setAttribute("draggable", "true");
          template.innerHTML = `
            <div class="spot-top">
              <span class="spot-title-label">æ™¯é»å¡ç‰‡</span>
              <div>
                <button class="btn-ghost btn-small upload-image-btn">ğŸ–¼ æ–°å¢åœ–ç‰‡</button>
                <input type="file" accept="image/*" multiple class="file-input image-input" />
              </div>
            </div>
            <div class="image-list"></div>
            <div class="field-label">æ™¯é»åç¨±</div>
            <div class="editable" contenteditable="true">æ–°çš„æ™¯é»</div>
            <div class="field-label">åœ°é»ï¼åœ°å€ï¼æ™‚é–“</div>
            <div class="editable" contenteditable="true">åœ¨é€™è£¡å¡«å…¥è©³ç´°è³‡è¨Šã€‚</div>
            <div class="spot-note">
              <div class="note-header">
                <span>å‚™è¨»</span>
                <div>
                  <button class="btn-ghost btn-small upload-note-image-btn">ğŸ–¼ æ–°å¢åœ–ç‰‡</button>
                  <input type="file" accept="image/*" multiple class="file-input note-image-input" />
                </div>
              </div>
              <div class="note-image-list"></div>
              <div class="editable" contenteditable="true">å‚™è¨»å…§å®¹ã€‚</div>
            </div>
          `;

          spots.appendChild(template);
          initSpotDragAndDrop();
          initImageButtons(template);
        });
      });
    }

    // ---------------- æ–°å¢ä¸€å¤© ----------------
    function initAddDayButton() {
      const btn = document.getElementById("add-day-btn");
      const dayList = document.getElementById("day-list");

      btn.addEventListener("click", () => {
        const dayCard = document.createElement("article");
        dayCard.className = "day-card";
        dayCard.setAttribute("draggable", "true");

        dayCard.innerHTML = `
          <div class="day-header">
            <div class="day-title">
              <span class="day-label">Day ?</span>
              <span class="day-date"></span>
              <span class="area-tag editable" contenteditable="true">æ–°å€åŸŸ</span>
            </div>
            <button class="btn-ghost btn-small add-spot-btn">ï¼‹ æ–°å¢æ™¯é»</button>
          </div>
          <div class="spots"></div>
        `;

        dayList.appendChild(dayCard);
        initDayDragAndDrop();
        initAddSpotButtons(dayCard);
        updateDayLabels(); // æ–°å¢å¾Œé‡æ’ Day ç·¨è™Ÿï¼†æ—¥æœŸ
      });
    }

    // ---------------- Day æ¨™ç±¤è‡ªå‹•é‡æ’ ----------------
    function updateDayLabels() {
      const dayCards = document.querySelectorAll("#day-list .day-card");
      dayCards.forEach((card, index) => {
        const label = card.querySelector(".day-label");
        if (label) label.textContent = `Day ${index + 1}`;
      });
      updateDates(); // æ¯æ¬¡ Day é †åºè®ŠåŒ–å°±åŒæ­¥é‡ç®—æ—¥æœŸ
    }

    // ---------------- å•Ÿå‹• ----------------
    document.addEventListener("DOMContentLoaded", init);
  </script>
</body>
</html>
